<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Method 1: Add CSS to show banner when parameter is set -->
    <template id="storage_quota_banner_css" inherit_id="web.assets_backend">
        <xpath expr="." position="inside">
            <style>
                /* Show banner if readonly mode is active */
                body[data-readonly-mode="true"]::before {
                    content: "â›” STORAGE QUOTA EXCEEDED - READ-ONLY MODE";
                    display: block;
                    background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
                    color: white;
                    padding: 15px 20px;
                    text-align: center;
                    font-weight: bold;
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    z-index: 10000;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                }
                
                body[data-readonly-mode="true"] {
                    padding-top: 60px !important;
                }
            </style>
        </xpath>
    </template>
    
    <!-- Method 2: Add data attribute via JavaScript -->
    <template id="storage_quota_banner_js" inherit_id="web.assets_backend">
        <xpath expr="." position="inside">
            <script type="text/javascript">
                (function() {
                    // Check if readonly mode on page load
                    odoo.define('storage_quota_check', function(require) {
                        'use strict';
                        
                        var ajax = require('web.ajax');
                        
                        // Check readonly mode
                        ajax.jsonRpc('/web/dataset/call_kw', 'call', {
                            model: 'ir.config_parameter',
                            method: 'get_param',
                            args: ['storage.readonly_mode', 'false'],
                            kwargs: {}
                        }).then(function(readonly_mode) {
                            if (readonly_mode === 'true') {
                                document.body.setAttribute('data-readonly-mode', 'true');
                            }
                        }).catch(function(error) {
                            console.warn('Storage quota check failed', error);
                        });
                    });
                })();
            </script>
        </xpath>
    </template>

</odoo>
